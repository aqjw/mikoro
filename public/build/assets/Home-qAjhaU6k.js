import{_ as P}from"./CardTitle-wRnwXS3-.js";import{a as c,o as v,g as $,w as o,d as n,t as b,f as F,q as S,b as s,m as D,c as O,s as I,r as w,j as V,y as L,z as T,u as r,Z as z,F as B,k as Q,A as q,x as H}from"./app-BtiNWB6H.js";import{u as R,_ as W}from"./AppLayout-Fq-3Wl7C.js";import{_ as Y}from"./InfiniteScroll-DhUsxcnK.js";import"./TitleRating-DgB4xwie.js";import"./Navbar-N5M_uYsX.js";import"./index-BEdA3Klw.js";import"./Footer-DZTSFuI_.js";const Z={class:"flex justify-between"},G={class:"flex items-center"},X={class:"font-medium text-lg text-gray-700 dark:text-gray-200 mr-2"},ee={class:"rounded-md overflow-hidden"},te={class:"flex flex-col gap-1"},se={key:0,class:"flex gap-1 text-gray-600 dark:text-gray-400 font-medium"},ne={key:1,class:"text-red-600 font-medium"},ie={class:"flex justify-between items-center"},oe={class:"flex gap-2 items-center pr-6 w-[90%]"},le={class:"truncate max-w-[190px]"},N={__name:"MenuFilterItem",props:{title:String,labelKey:{type:String,default:"name"},options:Array,items:Object},setup(t){const k=e=>{t.items.incl.includes(e)?(t.items.incl=t.items.incl.filter(d=>d!==e),t.items.excl.push(e)):t.items.excl.includes(e)?t.items.excl=t.items.excl.filter(d=>d!==e):t.items.incl.push(e)},u=e=>t.items.incl.includes(e)?"green":t.items.excl.includes(e)?"red":"default",y=e=>t.items.incl.includes(e)?"mdi-check-circle-outline":t.items.excl.includes(e)?"mdi-close-circle-outline":"mdi-circle-outline",x=e=>t.items.incl.includes(e)||t.items.excl.includes(e)?"tonal":"text",p=e=>t.items[e].map(d=>t.options.find(g=>g.id===d)[t.labelKey]);return(e,d)=>{const g=c("v-chip"),m=c("v-btn"),f=c("v-icon"),h=c("v-virtual-scroll"),l=c("v-card-text"),a=c("v-card"),_=c("v-menu");return v(),$(_,{rounded:"",location:"bottom end",origin:"auto",offset:"5","close-on-content-click":!1},{activator:o(({props:i})=>[n("div",Z,[n("div",G,[n("span",X,b(t.title),1),n("div",ee,[t.items.incl.length?(v(),$(g,{key:0,density:"compact",rounded:!1,variant:"tonal",color:"green"},{default:o(()=>[F(b(t.items.incl.length),1)]),_:1})):S("",!0),t.items.excl.length?(v(),$(g,{key:1,density:"compact",rounded:!1,variant:"tonal",color:"red"},{default:o(()=>[F(b(t.items.excl.length),1)]),_:1})):S("",!0)])]),s(m,D({variant:"tonal",density:"compact",rounded:"sm",color:"primary",icon:"mdi-list-status"},i),null,16)]),n("div",te,[t.items.incl.length?(v(),O("div",se,b(p("incl").join(", ")),1)):S("",!0),t.items.excl.length?(v(),O("div",ne,[d[0]||(d[0]=n("span",{class:"font-semibold"},"Исключить:",-1)),F(" "+b(p("excl").join(", ")),1)])):S("",!0)])]),default:o(()=>[s(a,{width:"250px","max-height":"400px"},{default:o(()=>[s(l,{class:"!p-1 space-y-1"},{default:o(()=>[s(h,{items:t.options},{default:o(({item:i})=>[s(g,{class:"chip-content-full",ripple:!1,rounded:!1,variant:x(i.id),color:u(i.id),onClick:J=>k(i.id)},{default:o(()=>[n("div",ie,[n("div",oe,[s(f,{icon:y(i.id)},null,8,["icon"]),n("span",le,b(i[t.labelKey]),1)]),n("div",null,b(i.titles_count),1)])]),_:2},1032,["variant","color","onClick"])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})}}},ae={class:"grid grid-cols-4 gap-4"},re={class:"d-flex items-center"},ce={class:"d-flex items-end justify-end"},de={class:"d-flex items-center gap-2"},ue={__name:"SectionFilterSort",emits:["updated","reset"],setup(t,{emit:k}){const u=k,y=R(),{sorting:x,filters:p,options:e,activeFiltersCount:d,canReset:g}=I(y),m=w(JSON.parse(JSON.stringify(x.value))),f=w(JSON.parse(JSON.stringify(p.value)));let h=!1;V(m,()=>{h||(x.value=JSON.parse(JSON.stringify(m.value)),u("updated",!0))},{deep:!0}),V(f,()=>{h||(p.value=JSON.parse(JSON.stringify(f.value)),u("updated",!1))},{deep:!0}),V(x,()=>{l(()=>{m.value=JSON.parse(JSON.stringify(x.value))})},{deep:!0}),V(p,()=>{l(()=>{f.value=JSON.parse(JSON.stringify(p.value))})},{deep:!0}),L(()=>{y.$loadOptions()});const l=_=>{h=!0,_(),T(()=>h=!1)},a=()=>{m.value.dir=m.value.dir==="asc"?"desc":"asc"};return(_,i)=>{const J=c("v-select"),A=c("v-btn"),U=c("v-badge"),C=c("v-divider"),E=c("v-card-text"),K=c("v-card"),M=c("v-menu");return v(),O("div",ae,[n("div",null,[s(J,{items:r(e).sorting,modelValue:m.value.option,"onUpdate:modelValue":i[0]||(i[0]=j=>m.value.option=j),variant:"solo",color:"primary",density:"compact",rounded:"lg","hide-details":""},null,8,["items","modelValue"])]),n("div",re,[s(A,{density:"comfortable",icon:m.value.dir==="asc"?"mdi-sort-ascending":"mdi-sort-descending",variant:"tonal",rounded:"lg",color:"grey",onClick:a},null,8,["icon"])]),i[4]||(i[4]=n("div",null,null,-1)),n("div",ce,[n("div",de,[r(g)?(v(),$(A,{key:0,variant:"text",color:"red",density:"comfortable",class:"text-none",onClick:i[1]||(i[1]=j=>u("reset"))},{default:o(()=>i[2]||(i[2]=[F(" Сбросить ")])),_:1})):S("",!0),s(M,{rounded:"",location:"bottom end",origin:"auto",offset:"10","close-on-content-click":!1},{activator:o(({props:j})=>[s(A,D({rounded:"lg",class:"text-none"},j),{default:o(()=>[r(d)>0?(v(),$(U,{key:0,color:"green",content:r(d),inline:""},null,8,["content"])):S("",!0),i[3]||(i[3]=n("span",null,"Фильтры",-1))]),_:2},1040)]),default:o(()=>[s(K,{width:"300px","max-height":"500px"},{default:o(()=>[s(E,null,{default:o(()=>[s(N,{title:"Жанр",options:r(e).filters.genres,items:f.value.genres},null,8,["options","items"]),s(C,{opacity:"1",class:"my-4 -mx-4 border-gray-200 dark:border-gray-500/30"}),s(N,{title:"Озвучка","label-key":"title",options:r(e).filters.translations,items:f.value.translations},null,8,["options","items"]),s(C,{opacity:"1",class:"my-4 -mx-4 border-gray-200 dark:border-gray-500/30"}),s(N,{title:"Студия",options:r(e).filters.studios,items:f.value.studios},null,8,["options","items"]),s(C,{opacity:"1",class:"my-4 -mx-4 border-gray-200 dark:border-gray-500/30"}),s(N,{title:"Страны",options:r(e).filters.countries,items:f.value.countries},null,8,["options","items"]),s(C,{opacity:"1",class:"my-4 -mx-4 border-gray-200 dark:border-gray-500/30"}),s(N,{title:"Год",options:r(e).filters.years,items:f.value.years},null,8,["options","items"])]),_:1})]),_:1})]),_:1})])])])}}},me={class:"mb-4"},fe={class:"my-4 flex justify-between"},ve={class:"font-semibold"},ge={class:"grid grid-cols-4 gap-4 mb-4"},pe=1e3,Oe={__name:"Home",props:{filter:{type:Object,default:null}},setup(t){const k=t,u=R(),{items:y,total:x,has_more:p}=I(u),e=w(null),d=w(null),g=w(!1),m=l=>{const a=()=>{var _;u.$resetPage(),(_=e.value)==null||_.load()};if(clearTimeout(d.value),l){a();return}d.value=setTimeout(a,pe)},f=()=>{var l;u.$resetAll(),(l=e.value)==null||l.reload(),route().current().startsWith("catalog.")&&H.visit(route("home"))};L(()=>{var l;(l=k.filter)!=null&&l.key?(u.$resetAll(),u.$setFilterValue(k.filter.key,k.filter.value),T(()=>{var a;return(a=e.value)==null?void 0:a.load()})):y.value.length===0&&T(()=>{var a;return(a=e.value)==null?void 0:a.load()})});const h=l=>{g.value=!0,u.$loadItems({success:()=>{},error:()=>{},finish:()=>{g.value=!1,l()}})};return(l,a)=>{const _=c("v-progress-circular");return v(),O(B,null,[s(r(z),{title:"Anime"}),s(W,null,{default:o(()=>[n("div",me,[s(ue,{onUpdated:m,onReset:f}),n("div",fe,[n("div",null,[a[0]||(a[0]=n("span",{class:"mr-2"},"Всего найдено тайтлов:",-1)),n("span",ve,b(r(x)),1)]),n("div",null,[g.value?(v(),$(_,{key:0,color:"primary",indeterminate:"",size:20,width:2})):S("",!0)])]),s(Y,{ref_key:"infiniteScroll",ref:e,items:r(y),"has-more":r(p),"on-load":h},{default:o(()=>[n("div",ge,[(v(!0),O(B,null,Q(r(y),(i,J)=>(v(),O("div",{key:J,class:"hover:scale-105 duration-200"},[s(r(q),{href:l.route("title",i.slug)},{default:o(()=>[s(P,{item:i},null,8,["item"])]),_:2},1032,["href"])]))),128))])]),_:1},8,["items","has-more"])])]),_:1})],64)}}};export{Oe as default};
