import{_ as F}from"./Navbar-OEx2-vpd.js";import{K as A,r as f,j as w,a as n,o as a,g as d,w as l,b as i,m as C,c as h,F as y,k,e as O,t as V,x,d as N,h as j}from"./app-dxeBQ7nv.js";import{_ as B}from"./Footer-BlmDno5l.js";const $={option:"latest",dir:"desc"},E=()=>({page:1,total:0,items:[],has_more:!0,sorting:{...$},filters:{genres:{incl:[],excl:[]},studios:{incl:[],excl:[]},countries:{incl:[],excl:[]},translations:{incl:[],excl:[]},years:{incl:[],excl:[]}},options:{sorting:[{value:"latest",title:"Последние поступления"},{value:"rating",title:"По рейтингу"},{value:"comments_count",title:"По комментариям"},{value:"episodes_count",title:"По количеству эпизодов"},{value:"seasons_count",title:"По количеству сезонов"}],filters:{genres:[],studios:[],countries:[],translations:[],years:[]}}}),L={params(){return{page:this.page,filters:this.filters,sorting:this.sorting}},activeFiltersCount(){return Object.values(this.filters).filter(t=>t.incl.length||t.excl.length).length},canReset(){return this.activeFiltersCount||JSON.stringify($)!==JSON.stringify(this.sorting)}},T={$resetAll(){this.$resetSorting(),this.$resetFilters(),this.$resetPage()},$resetPage(){this.page=1},$resetItems(){this.items=[],this.has_more=!0},$resetSorting(){this.sorting=$},$resetFilters(){Object.keys(this.filters).forEach(t=>{this.filters[t]={incl:[],excl:[]}})},$setFilterValue(t,e){this.filters[t].incl=[e]},$loadOptions(){axios.get(route("upi.title.filters")).then(({data:t})=>{this.options.filters.genres=t.genres,this.options.filters.studios=t.studios,this.options.filters.countries=t.countries,this.options.filters.translations=t.translations,this.options.filters.years=t.years}).catch(t=>{console.error(t)})},$loadItems(t){axios.get(route("upi.title.catalog"),{params:this.params}).then(({data:e})=>{this.page===1&&this.$resetItems(),this.page++,this.items.push(...e.items),this.total=e.total,this.has_more=e.has_more,t.success()}).catch(({response:e})=>{t.error(e)}).finally(()=>{t.finish()})}},D=A("catalogStore",{state:E,getters:L,actions:T}),M={key:0,class:"flex justify-center"},P={key:1,class:"grid grid-cols-4 gap-2"},J=["onClick"],R={__name:"MenuList",props:{label:String,loadItems:Function,actionItem:Function},setup(t){const e=t,c=f([]),u=f(!1),s=f(!1),r=()=>{c.value.length||(u.value=!0,e.loadItems(_=>{c.value=_,u.value=!1}))};return w(s,_=>{_&&r()}),(_,m)=>{const o=n("v-list-item"),g=n("v-progress-circular"),v=n("v-card-text"),b=n("v-card"),S=n("v-menu");return a(),d(S,{modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=p=>s.value=p),rounded:"",location:"end","close-on-content-click":!1},{activator:l(({props:p})=>[i(o,C({title:t.label},p),null,16,["title"])]),default:l(()=>[i(b,{"min-width":"200px"},{default:l(()=>[i(v,null,{default:l(()=>[u.value?(a(),h("div",M,[i(g,{indeterminate:"",size:30,width:2,color:"primary"})])):(a(),h("div",P,[(a(!0),h(y,null,k(c.value,(p,I)=>(a(),h("a",{key:I,href:"#",onClick:O(G=>t.actionItem(p),["prevent"])},V(p.name),9,J))),128))]))]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},U={__name:"Sidebar",setup(t){const e=D(),c=(s,r)=>{s.preventDefault(),x.visit(r.href)},u=f([{label:"Новинки",href:route("home"),isActive:()=>route().current("home"),action:(s,r)=>{e.$resetAll(),e.$resetItems(),c(s,r)}},{label:"Япония",href:route("catalog.country","iaponiia"),isActive:()=>route().current("catalog.country","iaponiia"),action:c},{label:"Китай",href:route("catalog.country","kitai"),isActive:()=>route().current("catalog.country","kitai"),action:c},{label:"Жанры",list:!0,loadItems:s=>{axios.get(route("upi.title.genres")).then(({data:r})=>{s(r.genres)})},actionItem:s=>{x.visit(route("catalog.genre",s.slug))}}]);return(s,r)=>{const _=n("v-list-item"),m=n("v-list");return a(),d(m,{rounded:"lg",class:"!shadow-md"},{default:l(()=>[(a(!0),h(y,null,k(u.value,(o,g)=>(a(),h(y,{key:g},[o.list?(a(),d(R,{key:0,label:o.label,"load-items":o.loadItems,"action-item":o.actionItem},null,8,["label","load-items","action-item"])):(a(),d(_,{key:1,title:o.label,href:o.href,active:o.isActive(),color:"primary",onClick:v=>o.action(v,o)},null,8,["title","href","active","onClick"]))],64))),128))]),_:1})}}},z={class:"sticky top-[64px]"},Q={__name:"AppLayout",setup(t){return(e,c)=>{const u=n("v-col"),s=n("v-sheet"),r=n("v-row"),_=n("v-container"),m=n("v-main"),o=n("v-app");return a(),d(o,{id:"inspire",class:"bg-transparent"},{default:l(()=>[i(F),i(m,null,{default:l(()=>[i(_,null,{default:l(()=>[i(r,null,{default:l(()=>[i(u,{cols:"2"},{default:l(()=>[N("div",z,[i(U)])]),_:1}),i(u,null,{default:l(()=>[i(s,{"min-height":"70vh",rounded:"lg",class:"bg-transparent"},{default:l(()=>[j(e.$slots,"default")]),_:3})]),_:3})]),_:3})]),_:3})]),_:3}),i(B)]),_:3})}}};export{Q as _,D as u};
