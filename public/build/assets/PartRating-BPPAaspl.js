import{f as g,h as b}from"./index-BEdA3Klw.js";import{_ as q}from"./DialogLoginRequires-CqwYax18.js";import{l as B,B as C,s as N,r as v,a as f,o as c,c as d,b as a,q as h,d as s,t as n,u as _}from"./app-dxeBQ7nv.js";const S={class:"py-4"},V={key:0,class:"absolute right-2 top-2"},E={class:"flex align-center flex-col"},U={class:"text-h3"},w={class:"mx-1"},z={class:"text-sm"},F={key:0,class:"mt-1 text-xs opacity-50"},T={class:"flex align-center flex-col"},$={class:"text-h3"},j={class:"mx-1"},D={class:"text-sm"},A={__name:"PartRating",props:{title:Object,required:!0},setup(t){const i=t,x=B.useToast(),p=C(),{isLogged:k}=N(p),l=v(!1),m=v(null),y=o=>{if(!k.value){m.value.open();return}l.value=!0,axios.post(route("upi.title.rating",i.title.id),{value:o}).then(({data:e})=>{i.title.rating=e.rating,i.title.rating_votes=e.rating_votes,i.title.user_voted=!0}).catch(({response:e})=>{x.error(b(e))}).finally(()=>{l.value=!1})},r=o=>o?o>=7?"green-darken-3":o>=5?"yellow-darken-3":"red-darken-3":"primary";return(o,e)=>{const R=f("v-progress-circular"),u=f("v-rating");return c(),d("div",S,[l.value?(c(),d("div",V,[a(R,{color:"primary",indeterminate:"",size:20,width:2})])):h("",!0),s("div",E,[s("div",U,[e[0]||(e[0]=s("span",{class:"text-sm"},"Наш",-1)),s("span",w,n(t.title.rating.toFixed(1)),1),s("span",z,"("+n(_(g)(t.title.rating_votes))+")",1)]),a(u,{"model-value":t.title.rating,"active-color":r(t.title.rating),color:r(t.title.rating),length:"10","half-increments":"",density:"compact",hover:"","onUpdate:modelValue":y},null,8,["model-value","active-color","color"]),t.title.user_voted?(c(),d("div",F,"Ваш голос учтен")):h("",!0)]),e[2]||(e[2]=s("div",{class:"divider-horizontal my-4"},null,-1)),s("div",T,[s("div",$,[e[1]||(e[1]=s("span",{class:"text-sm"},"Shikimori",-1)),s("span",j,n(t.title.shikimori_rating.toFixed(1)),1),s("span",D,"("+n(_(g)(t.title.shikimori_votes))+")",1)]),a(u,{"model-value":t.title.shikimori_rating,"active-color":r(t.title.shikimori_rating),color:r(t.title.shikimori_rating),length:"10","half-increments":"",density:"compact",readonly:""},null,8,["model-value","active-color","color"])]),a(q,{ref_key:"loginRequires",ref:m},null,512)])}}};export{A as default};
