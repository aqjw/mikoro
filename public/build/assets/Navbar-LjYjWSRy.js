import{a as o,o as n,g as d,w as e,b as t,m as M,c as x,t as $,u as z,q as Q,d as h,e as Z,f as V,l as se,V as ie,s as ee,r as k,j as I,F as N,k as q,x as re,A as W,W as ce,n as L,y as ue,X as de,Y as me,D as ve,_ as X,B as _e}from"./app-GZlwl0sp.js";import{i as pe,h as H}from"./index-BEdA3Klw.js";import{_ as fe}from"./TitleRating-D4ZtZ2vx.js";const ge={key:0,class:"text-lg font-semibold text-white absolute-center"},ye={class:"mx-auto text-center p-4"},be={class:"text-lg mt-2"},he={class:"flex items-center gap-4 pr-2"},ke={class:"flex justify-between items-center w-full"},xe={class:"flex items-center gap-4 pr-2"},we={class:"flex items-center gap-4 pr-2"},$e={__name:"MenuProfile",props:{user:Object},setup(c){return(m,a)=>{const r=o("v-img"),p=o("v-btn"),s=o("v-icon"),v=o("v-list-item"),y=o("v-list"),u=o("v-card-text"),w=o("v-card"),f=o("v-menu");return n(),d(f,{rounded:"",location:"bottom end",origin:"auto","close-on-content-click":!1},{activator:e(({props:S})=>[t(p,M({icon:""},S),{default:e(()=>[t(r,{class:"h-10 w-10 bg-zinc-400 dark:bg-zinc-500 rounded-full mx-auto",src:m.$media.image(c.user.avatar)},{default:e(()=>[c.user.avatar?Q("",!0):(n(),x("span",ge,$(z(pe)(c.user.name)),1))]),_:1},8,["src"])]),_:2},1040)]),default:e(()=>[t(w,{width:"200px"},{default:e(()=>[t(u,{class:"!p-0"},{default:e(()=>[h("div",ye,[c.user.avatar?(n(),d(r,{key:0,class:"h-16 w-16 bg-zinc-400 dark:bg-zinc-500 rounded-full mx-auto",src:m.$media.image(c.user.avatar)},null,8,["src"])):Q("",!0),h("div",be,$(c.user.name),1)]),t(y,{density:"compact",class:"!pt-0"},{default:e(()=>[t(v,{to:m.route("profile")},{default:e(()=>[h("div",he,[t(s,{size:"small",icon:"mdi-account-outline",variant:"tonal"}),h("div",ke,[a[2]||(a[2]=h("span",{class:"text-sm"},$("Profile"),-1)),t(p,{variant:"tonal",density:"comfortable",size:"small",class:"text-none !min-w-0 !px-2",to:m.route("profile.edit"),onClick:a[0]||(a[0]=Z(()=>{},["stop","prevent"]))},{default:e(()=>a[1]||(a[1]=[V(" Ред. ")])),_:1},8,["to"])])])]),_:1},8,["to"]),t(v,{to:m.route("settings")},{default:e(()=>[h("div",xe,[t(s,{size:"small",icon:"mdi-cog-outline",variant:"tonal"}),a[3]||(a[3]=h("span",{class:"text-sm"},$("Settings"),-1))])]),_:1},8,["to"]),t(v,{"base-color":"red-lighten-1",to:{href:m.route("logout"),method:"post"}},{default:e(()=>[h("div",we,[t(s,{size:"small",icon:"mdi-logout",variant:"tonal"}),a[4]||(a[4]=h("span",{class:"text-sm"},$("Log out"),-1))])]),_:1},8,["to"])]),_:1})]),_:1})]),_:1})]),_:1})}}},ze={key:0,class:"flex justify-center items-center p-12"},Ce={__name:"MenuNotification",setup(c){const m=se.useToast(),a=ie(),{items:r,unreadCount:p}=ee(a),s=k(!1),v=k(!1),y=k(!1);I(y,l=>{l&&u()});const u=()=>{const l=r.value.length;l>0&&l===p.value||(s.value=!0,a.$loadItems({success:()=>{},error:_=>{m.error(H(_))},finish:()=>{s.value=!1}}))},w=()=>{v.value=!0,a.$markReadAll({success:()=>{},error:l=>{m.error(H(l))},finish:()=>{v.value=!1}})},f=(l,_=null)=>{v.value||(l.loading=!0,a.$markRead(l.id,{success:()=>{_&&_()},error:C=>{m.error(H(C))},finish:()=>{l.loading=!1}}))},S=l=>{f(l,()=>{l.type=="new-episode"&&re.visit(route("title",l.data.title_slug),{data:{episode_id:l.data.episode_id,translation_id:l.data.translation_id}})})};return(l,_)=>{const C=o("v-btn"),j=o("v-badge"),A=o("v-toolbar-title"),O=o("v-spacer"),E=o("v-toolbar"),U=o("v-progress-circular"),i=o("v-list-item"),b=o("v-img"),B=o("v-list"),P=o("v-card"),Y=o("v-menu");return n(),d(Y,{modelValue:y.value,"onUpdate:modelValue":_[0]||(_[0]=g=>y.value=g),rounded:"",location:"bottom end",origin:"auto","close-on-content-click":!1},{activator:e(({props:g})=>[z(p)>0?(n(),d(j,{key:0,color:"primary",class:"noti-badge",content:z(p)},{default:e(()=>[t(C,M({density:"comfortable",icon:"mdi-bell-outline",variant:"plain"},g),null,16)]),_:2},1032,["content"])):(n(),d(C,M({key:1,density:"comfortable",icon:"mdi-bell-outline",variant:"plain"},g),null,16))]),default:e(()=>[t(P,{width:"450",rounded:"lg"},{default:e(()=>[t(E,{density:"compact"},{default:e(()=>[t(A,null,{default:e(()=>_[1]||(_[1]=[V("Уведомления")])),_:1}),t(O),z(r).length>0?(n(),d(C,{key:0,icon:"mdi-delete-empty-outline",color:"red",variant:"text",loading:v.value,onClick:w},null,8,["loading"])):Q("",!0)]),_:1}),s.value?(n(),x("div",ze,[t(U,{color:"primary",indeterminate:"",size:30,width:2})])):(n(),d(B,{key:1,lines:"two",density:"comfortable","max-height":"450"},{default:e(()=>[z(r).length==0?(n(),d(i,{key:0,class:"text-center"},{default:e(()=>_[2]||(_[2]=[V(" Нету уведомлений ")])),_:1})):(n(!0),x(N,{key:1},q(z(r),(g,F)=>(n(),d(i,{key:F,title:g.data.title,subtitle:g.data.subtitle,disabled:g.loading,onClick:K=>S(g)},{prepend:e(()=>[t(b,{width:50,height:70,rounded:"",cover:"",src:l.$media.image(g.data.image),class:"mr-4"},null,8,["src"])]),append:e(()=>[t(C,{density:"comfortable",size:"x-small",variant:"tonal",icon:"mdi-close",class:"ml-4",loading:g.loading,onClick:Z(K=>f(g),["stop"])},null,8,["loading","onClick"])]),_:2},1032,["title","subtitle","disabled","onClick"]))),128))]),_:1}))]),_:1})]),_:1},8,["modelValue"])}}},Ve={class:"d-flex gap-1 flex-wrap mt-1"},Se={key:0},Te={key:1},je={class:"d-flex gap-1 flex-wrap mt-1"},D={__name:"ItemTitle",props:{item:{type:Object,required:!0}},setup(c){return(m,a)=>{const r=o("v-chip"),p=o("v-img"),s=o("v-list-item");return n(),d(s,{title:c.item.title,onClick:()=>{}},{subtitle:e(()=>[h("div",Ve,[t(r,{size:"small",variant:"tonal",rounded:"sm",density:"compact"},{default:e(()=>[V($(c.item.year),1)]),_:1}),t(r,{size:"small",variant:"tonal",rounded:"sm",density:"compact"},{default:e(()=>[c.item.single_episode?(n(),x("span",Se,"Фильм")):(n(),x("span",Te,$(c.item.episodes)+" серия",1))]),_:1})]),h("div",je,[(n(!0),x(N,null,q(c.item.genres,v=>(n(),d(z(W),{key:v.slug,href:m.route("catalog.genre",v.slug)},{default:e(()=>[t(r,{size:"small",variant:"tonal",color:"primary",density:"compact",onClick:()=>{}},{default:e(()=>[V($(v.name),1)]),_:2},1024)]),_:2},1032,["href"]))),128))])]),prepend:e(()=>[t(p,{width:65,height:80,rounded:"","aspect-ratio":"1/1",cover:"",src:m.$media.image(c.item.poster),class:"mr-4"},null,8,["src"])]),append:e(()=>[t(fe,{value:c.item.shikimori_rating},null,8,["value"])]),_:1},8,["title"])}}},Ie={__name:"ItemStudio",props:{item:{type:Object,required:!0}},setup(c){return(m,a)=>{const r=o("v-list-item");return n(),d(r,{title:c.item.name,density:"compact",onClick:()=>{}},{append:e(()=>a[0]||(a[0]=[])),_:1},8,["title"])}}},Le={key:0,class:"p-12 d-flex justify-center items-center"},Ne={key:1,class:"p-12 d-flex justify-center items-center"},Ee={key:2},J=3,Re=500,De={__name:"DialogSearch",setup(c){const{mobile:m,platform:a}=ce(),r=k(!1),p=k(null),s=k("title"),v=k([{value:"title",label:"Тайтл"},{value:"studio",label:"Студия"}]),y=k(!1),u=k({raw:"",exact:""}),w=k(null),f=k({title:[],studio:[],director:[],voice_actor:[],character:[]}),S=k({title:[],studio:[],director:[],voice_actor:[],character:[]}),l=L(()=>u.value.exact.length>=J),_=L(()=>l.value?f.value[s.value]:S.value[s.value]),C=L(()=>({title:D,studio:Ie,director:D,voice_actor:D,character:D})[s.value]),j=L(()=>s.value==="studio"?"one":"two");I(r,i=>{i&&U()}),I(s,()=>{l.value&&!f.value[s.value].length&&E()}),I(()=>u.value.raw,i=>{if(i===null){u.value.raw="";return}const b=i.length;clearTimeout(w.value),w.value=setTimeout(()=>{b>=J?u.value.exact=i:l.value&&b===0&&(u.value.exact="")},Re)}),I(()=>u.value.exact,i=>{A(),l.value?E():f.value[s.value]=[]});const A=()=>{for(const i of Object.keys(f.value))i!==s.value&&(f.value[i]=[])},O=i=>({title:route("title",i.slug),studio:route("catalog.studio",i.slug),director:"",voice_actor:"",character:""})[s.value],E=async()=>{y.value=!0,axios.get(route("upi.search.query",{type:s.value,query:u.value.exact})).then(({data:i})=>{f.value[s.value]=i}).finally(()=>{y.value=!1})},U=()=>{y.value=!0,axios.get(route("upi.search.random")).then(({data:i})=>{S.value=i}).finally(()=>{y.value=!1})};return ue(()=>{(a.value.mac||a.value.win||a.value.linux)&&(p.value=a.value.mac?"cmd+k":"ctrl+k",window.addEventListener("keydown",i=>{(i.metaKey||i.ctrlKey)&&i.key==="k"&&(i.preventDefault(),r.value=!0)}))}),(i,b)=>{const B=o("v-icon"),P=o("v-chip"),Y=o("v-btn"),g=o("v-text-field"),F=o("v-tab"),K=o("v-tabs"),te=o("v-progress-circular"),oe=o("v-list"),ne=o("v-card-text"),ae=o("v-card"),le=o("v-dialog");return n(),d(le,{modelValue:r.value,"onUpdate:modelValue":b[2]||(b[2]=R=>r.value=R),"max-width":"600",opacity:.6},{activator:e(({props:R})=>[t(Y,M({variant:"tonal",color:"grey",class:"text-none !justify-between",width:"200",rounded:"lg"},R),de({prepend:e(()=>[t(B,{icon:"mdi-magnify"}),b[3]||(b[3]=h("span",{class:"ml-1"},"Search",-1))]),_:2},[p.value?{name:"append",fn:e(()=>[t(P,{size:"small",variant:"tonal",rounded:"sm",density:"comfortable"},{default:e(()=>[V($(p.value),1)]),_:1})]),key:"0"}:void 0]),1040)]),default:e(({isActive:R})=>[t(ae,{rounded:"lg"},{default:e(()=>[t(ne,{class:"!p-4 !pb-0"},{default:e(()=>[t(g,{modelValue:u.value.raw,"onUpdate:modelValue":b[0]||(b[0]=T=>u.value.raw=T),density:"compact",placeholder:"What are you looking for?",rounded:"lg",variant:"solo",autofocus:"","hide-details":"","single-line":"",clearable:"","persistent-clear":""},null,8,["modelValue"]),t(K,{modelValue:s.value,"onUpdate:modelValue":b[1]||(b[1]=T=>s.value=T),density:"compact",class:"mt-4 w-fit rounded-lg"},{default:e(()=>[(n(!0),x(N,null,q(v.value,({value:T,label:G},qe)=>(n(),d(F,{value:T,class:"text-none",ripple:!1},{default:e(()=>[V($(G),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),y.value?(n(),x("div",Le,[t(te,{indeterminate:"",size:50,width:2,color:"primary"})])):_.value.length===0?(n(),x("div",Ne,$(s.value)+" not found 🤷‍♂️ ",1)):(n(),x("div",Ee,[t(oe,{lines:j.value,density:"comfortable","max-height":"500"},{default:e(()=>[(n(!0),x(N,null,q(_.value,(T,G)=>(n(),d(z(W),{key:G,href:O(T)},{default:e(()=>[(n(),d(me(C.value),{item:T},null,8,["item"]))]),_:2},1032,["href"]))),128))]),_:1},8,["lines"])]))]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Me={class:"d-flex align-center gap-3"},Be={__name:"Navbar",setup(c){const m=ve(),a=k(X.get("theme","light")),r=L(()=>a.value==="dark"),p=_e(),{isLogged:s,user:v}=ee(p);function y(){a.value=r.value?"light":"dark",m.global.name.value=a.value,X.set("theme",a.value),r.value?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}return(u,w)=>{const f=o("v-col"),S=o("v-spacer"),l=o("v-btn"),_=o("v-row"),C=o("v-container"),j=o("v-app-bar");return n(),d(j,{flat:"",density:"comfortable",class:"!shadow-"},{default:e(()=>[t(C,null,{default:e(()=>[t(_,null,{default:e(()=>[t(f,{cols:"2",class:"d-flex align-center"},{default:e(()=>[t(z(W),{href:u.route("home"),class:"text-2xl font-semibold mr-10 text-zinc-800 dark:text-zinc-200 no-underline"},{default:e(()=>w[0]||(w[0]=[V(" mikoro.tv ")])),_:1},8,["href"])]),_:1}),t(f,{class:"mx-auto d-flex align-center justify-center"},{default:e(()=>[t(De),t(S),h("div",Me,[t(l,{density:"comfortable",icon:r.value?"mdi-weather-night":"mdi-white-balance-sunny",variant:"plain",onClick:y},null,8,["icon"]),z(s)?(n(),x(N,{key:0},[t(l,{density:"comfortable",icon:"mdi-bookmark-outline",variant:"plain",active:u.route().current("bookmarks"),"active-color":"primary",to:u.route("bookmarks")},null,8,["active","to"]),t(Ce),t($e,{user:z(v)},null,8,["user"])],64)):(n(),d(l,{key:1,to:u.route("login"),variant:"tonal",class:"text-none",color:"primary",density:"comfortable"},{default:e(()=>w[1]||(w[1]=[V(" Login ")])),_:1},8,["to"]))])]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Be as _};
